import{a as E,p as V,r as C,o as l,h as u,f as e,F as _,q as P,s as I,u as t,t as f,v as x,x as U,i as d,w as a,l as $,y as F,z as T,A as D,k as j,B as J,C as Q,D as W,E as X,c as w,G as S,H as ee,I as te}from"./entry.8297d1ff.js";import{_ as ne}from"./FilepathItem.vue.22e62c13.js";import{_ as le}from"./NPanelGrids.f0b55b40.js";import{_ as oe}from"./PanelLeftRight.vue.b6fba8cf.js";import{_ as ie}from"./NTextInput.vue.3d7af8ee.js";import{_ as se}from"./NTip.vue.d3e88526.js";import{_ as re}from"./NCodeBlock.vue.7df96def.js";import{_ as ae}from"./NCheckbox.vue.2dbb6d84.js";import"./editor.e9488ebd.js";import"./client.64d509dc.js";const ue={"h-full":"",grid:"~ rows-[max-content_1fr]"},de={flex:"~ wrap","w-full":""},ce=["onClick"],me=e("div",{border:"b base","flex-auto":""},null,-1),_e={key:0,flex:"~ col gap-4 items-center justify-center",p4:""},fe=e("div",{"flex-auto":""},null,-1),ve={grid:"~ cols-[30px_1fr] gap-x-2 gap-y-3 items-center justify-center","w-100":""},pe=e("div",{"i-carbon-commit":"","text-xl":""},null,-1),he=e("div",{"text-sm":"",op50:""}," Name ",-1),xe=e("div",{"i-carbon-time":"","text-xl":""},null,-1),$e=e("div",{"text-sm":"",op50:""}," Build duration ",-1),ge=e("div",{"i-carbon-cics-program":"","text-xl":""},null,-1),ye=e("div",{"text-sm":"",op50:""}," Client bundle size ",-1),be=e("div",{"i-carbon-bare-metal-server":"","text-xl":""},null,-1),we=e("div",{"text-sm":"",op50:""}," Nitro bundle size ",-1),Be=e("div",{"i-carbon-edge-node":"","text-xl":""},null,-1),ze=e("div",{"text-sm":"",op50:""}," Built ",-1),ke=e("div",{"i-carbon:folder-parent":"","text-xl":""},null,-1),Ce=e("div",{"text-sm":"",op50:""}," Report Path ",-1),Ne=e("div",{"flex-auto":""},null,-1),A="/__nuxt_devtools__/analyze/",Te=E({__name:"BuildAnalyzeDetails",props:{current:null,prev:null},setup(o){const g=o,v=V(()=>{const n=[{name:"Overview",id:"overview"}];return g.current.features.bundleClient&&n.push({name:"Client Bundle",id:"bundle-client"}),g.current.features.bundleNitro&&n.push({name:"Nitro Bundle",id:"bundle-nitro"}),g.current.features.viteInspect&&n.push({name:"Vite Inspect",id:"vite-inspect"}),n}),s=C(v.value[0]);function B(n){return n<1024?`${n}B`:n<1024*1024?`${(n/1024).toFixed(1)}KB`:n<1024*1024*1024?`${(n/1024/1024).toFixed(1)}MB`:`${(n/1024/1024/1024).toFixed(1)}GB`}function b(n){return`${((n.endTime-n.startTime)/1e3).toFixed(1)}s`}return(n,i)=>{const m=ne,N=j;return l(),u("div",ue,[e("div",de,[(l(!0),u(_,null,P(t(v),(p,z)=>(l(),u("button",{key:z,px4:"",py2:"",border:"r base",hover:"bg-active",class:I(p.id===t(s).id?"":"border-b"),onClick:R=>s.value=p},[e("div",{class:I(p.id===t(s).id?"":"op30")},f(p.name),3)],10,ce))),128)),me]),t(s).id==="overview"?(l(),u("div",_e,[fe,e("div",ve,[pe,e("div",null,[he,e("div",null,f(o.current.name),1)]),xe,e("div",null,[$e,e("div",null,f(b(o.current)),1)]),o.current.size?.clientBundle?(l(),u(_,{key:0},[ge,e("div",null,[ye,e("div",null,f(B(o.current.size.clientBundle)),1)])],64)):x("",!0),o.current.size.nitroBundle?(l(),u(_,{key:1},[be,e("div",null,[we,e("div",null,f(B(o.current.size.nitroBundle)),1)])],64)):x("",!0),Be,e("div",null,[ze,e("div",null,f(t(U)(new Date(o.current.endTime))),1)]),ke,e("div",null,[Ce,d(m,{filepath:o.current.analyzeDir},null,8,["filepath"])])]),Ne,d(N,{n:"rose",icon:"carbon-delete",onClick:i[0]||(i[0]=p=>("rpc"in n?n.rpc:t(F)).clearAnalyzeBuilds([o.current.name]))},{default:a(()=>[$(" Delete this report ")]),_:1})])):x("",!0),i._lazyshow1||t(s).id==="bundle-client"?(i._lazyshow1=!0,l(),u(_,null,[T(e("iframe",{src:`${A}${o.current.slug}/client.html`,"h-full":"","w-full":""},null,8,["src"]),[[D,t(s).id==="bundle-client"]])],64)):x("v-show-if",!0),i._lazyshow2||t(s).id==="bundle-nitro"?(i._lazyshow2=!0,l(),u(_,null,[T(e("iframe",{src:`${A}${o.current.slug}/nitro.html`,"h-full":"","w-full":""},null,8,["src"]),[[D,t(s).id==="bundle-nitro"]])],64)):x("v-show-if",!0),i._lazyshow3||t(s).id==="vite-inspect"?(i._lazyshow3=!0,l(),u(_,null,[T(e("iframe",{src:`${A}${o.current.slug}/.vite-inspect/`,"h-full":"","w-full":""},null,8,["src"]),[[D,t(s).id==="vite-inspect"]])],64)):x("v-show-if",!0)])}}}),De={flex:"~ col"},Ae={flex:"~ gap-1 items-center","text-sm":"",op60:""},Ve=e("div",{"i-carbon-time":""},null,-1),Ie=e("div",{"flex-auto":""},null,-1),Fe=e("div",{"x-divider":""},null,-1),Re={flex:"~ items-center justify-center",p4:""},Se={flex:"~ col gap-1","w-250":"",p4:""},Ee=e("h3",{class:"text-lg font-medium leading-6",mb2:""}," Start analyze build? ",-1),Pe=e("p",{op50:""}," Enter the name of the build: ",-1),Ue=e("div",{my3:"","x-divider":""},null,-1),je=e("p",{op50:""}," The following command will be executed in your terminal: ",-1),Ge={flex:"~ gap-3",mt2:"","justify-end":""},We=E({__name:"analyze-build",setup(o){const g=J(),v=Q(),s=W(),B=X(),b=C(),n=V(()=>{const h=B.query.slug;return v.value?.builds.find(c=>c.slug===h)??v.value?.builds[0]}),i=C(!1),m=C(""),N=V(()=>v.value?.builds.some(h=>h.name===m.value.trim()));async function p(){m.value=await F.generateAnalyzeBuildName(),await g.start()&&(b.value=await F.startAnalyzeBuild(m.value),i.value&&z())}function z(){b.value&&s.push(`/modules/terminals?id=${encodeURIComponent(b.value)}`)}function R(h){return`${((h.endTime-h.startTime)/1e3).toFixed(1)}s`}return(h,c)=>{const G=ee,k=j,L=Te,q=le,O=oe,H=ie,K=se,M=re,Y=ae,Z=te;return l(),u(_,null,[d(O,{"left-size":20},{left:a(()=>[e("div",De,[(l(!0),u(_,null,P(t(v)?.builds,r=>(l(),u(_,{key:r.slug},[d(G,{flex:"~ col gap1","hover:bg-active":"",p3:"",class:I(r.slug===t(n)?.slug?"text-primary bg-active":""),to:`?slug=${encodeURIComponent(r.slug)}`},{default:a(()=>[e("code",null,f(r.name),1),e("div",Ae,[Ve,e("span",null,f(R(r)),1),Ie,e("span",null,f(t(U)(new Date(r.endTime))),1)])]),_:2},1032,["class","to"]),Fe],64))),128)),e("div",Re,[t(v)?.isBuilding?(l(),w(k,{key:1,n:"primary",icon:"carbon-circle-dash animate-spin",onClick:c[1]||(c[1]=r=>z())},{default:a(()=>[$(" Building... ")]),_:1})):(l(),w(k,{key:0,n:"primary",icon:"carbon-edge-node",onClick:c[0]||(c[0]=r=>p())},{default:a(()=>[$(" Start a new build ")]),_:1}))])])]),right:a(()=>[t(n)?(l(),w(L,{key:0,current:t(n)},null,8,["current"])):(l(),w(q,{key:1}))]),_:1}),d(t(g),null,{default:a(({resolve:r})=>[d(Z,{"model-value":!0,onClose:y=>r(!1)},{default:a(()=>[e("div",Se,[Ee,Pe,d(H,{modelValue:t(m),"onUpdate:modelValue":c[2]||(c[2]=y=>S(m)?m.value=y:null),placeholder:"Build name"},null,8,["modelValue"]),t(N)?(l(),w(K,{key:0,"n-orange":""},{default:a(()=>[$(" A build with the same name already exists, continue would overrides the previous build result. ")]),_:1})):x("",!0),Ue,je,d(M,{code:`npx nuxi analyze --no-serve --name=${t(m)}`,lang:"bash",px4:"",py2:"",border:"~ base rounded",lines:!1},null,8,["code"]),d(Y,{modelValue:t(i),"onUpdate:modelValue":c[3]||(c[3]=y=>S(i)?i.value=y:null),mt2:"",n:"primary"},{default:a(()=>[$(" Navigate to terminal ")]),_:1},8,["modelValue"]),e("div",Ge,[d(k,{onClick:y=>r(!1)},{default:a(()=>[$(" Cancel ")]),_:2},1032,["onClick"]),d(k,{n:"solid primary",onClick:y=>r(!0)},{default:a(()=>[$(" Start ")]),_:2},1032,["onClick"])])])]),_:2},1032,["onClose"])]),_:1})],64)}}});export{We as default};
